/*! For license information please see b078aec5.7e207ad0.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{140:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return c})),n.d(t,"metadata",(function(){return b})),n.d(t,"rightToc",(function(){return p})),n.d(t,"default",(function(){return m}));var a=n(1),i=n(6),l=(n(0),n(160)),r=n(164),o=n(163),c={id:"relationships",title:"Relationships",sidebar_label:"Relationships"},b={id:"graphql_schema/relationships",title:"Relationships",description:"GraphQLize identifies the relationships between database tables using their foreign keys, and generate appropriate relationship fields (connections) in the resulting GraphQL schema.",source:"@site/docs/graphql_schema/relationships.mdx",permalink:"/docs/graphql_schema/relationships",editUrl:"https://github.com/graphqlize/graphqlize.github.io/tree/source/docs/graphql_schema/relationships.mdx",sidebar_label:"Relationships",sidebar:"docs",previous:{title:"Types & Fields",permalink:"/docs/graphql_schema/types-and-fields"},next:{title:"Custom Scalar Types",permalink:"/docs/graphql_schema/custom-scalar-types"}},p=[{value:"One to One",id:"one-to-one",children:[]},{value:"One to Many",id:"one-to-many",children:[]},{value:"Many to Many",id:"many-to-many",children:[]},{value:"Foreign Key Without the Id Suffix",id:"foreign-key-without-the-id-suffix",children:[]}],s={rightToc:p};function m(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(l.b)("wrapper",Object(a.a)({},s,n,{components:t,mdxType:"MDXLayout"}),Object(l.b)("p",null,"GraphQLize identifies the relationships between database tables using their foreign keys, and generate appropriate relationship fields (connections) in the resulting GraphQL schema."),Object(l.b)("h2",{id:"one-to-one"},"One to One"),Object(l.b)("p",null,Object(l.b)("img",Object(a.a)({parentName:"p"},{src:"/img/address_city_country_er_diagram.png",alt:null}))),Object(l.b)("p",null,"For the database table relationships like above, GraphQLize infers two ",Object(l.b)("inlineCode",{parentName:"p"},"one-to-one")," relationships."),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"An ",Object(l.b)("inlineCode",{parentName:"p"},"address")," is associated with a ",Object(l.b)("inlineCode",{parentName:"p"},"city")," via ",Object(l.b)("inlineCode",{parentName:"p"},"city_id")," column in the ",Object(l.b)("inlineCode",{parentName:"p"},"address")," table.")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"A ",Object(l.b)("inlineCode",{parentName:"p"},"city")," is associated with a ",Object(l.b)("inlineCode",{parentName:"p"},"country")," via ",Object(l.b)("inlineCode",{parentName:"p"},"country_id")," column in the ",Object(l.b)("inlineCode",{parentName:"p"},"city")," table."))),Object(l.b)("p",null,"GraphQLize then create two object relationships in the ",Object(l.b)("inlineCode",{parentName:"p"},"Address")," and the ",Object(l.b)("inlineCode",{parentName:"p"},"City")," type respectively."),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-graphql"}),"type Address {\n  # ...\n  city: City!\n}\n\ntype City {\n  # ...\n  country: Country!\n}\n")),Object(l.b)("p",null,"The generated field name is the ",Object(l.b)("em",{parentName:"p"},"camelCase")," version of the corresponding column name with the id suffix (",Object(l.b)("inlineCode",{parentName:"p"},"_id"),") removed."),Object(l.b)("p",null,"Here are some of the examples."),Object(l.b)("table",null,Object(l.b)("thead",{parentName:"table"},Object(l.b)("tr",{parentName:"thead"},Object(l.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"Column Name"),Object(l.b)("th",Object(a.a)({parentName:"tr"},{align:null}),"GraphQL Field Name"))),Object(l.b)("tbody",{parentName:"table"},Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"actor_id"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"actor")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"original_language_id"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"originalLanguage")),Object(l.b)("tr",{parentName:"tbody"},Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"reports_to_employee_id"),Object(l.b)("td",Object(a.a)({parentName:"tr"},{align:null}),"reportsToEmployee")))),Object(l.b)("p",null,"By default, GraphQLize assumes ",Object(l.b)("inlineCode",{parentName:"p"},"_id")," as the suffix for foreign keys in both Postgres and MySQL."),Object(l.b)("p",null,Object(l.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/graphqlize/graphqlize/issues/4"}),"In future"),", GraphQLize will provide a configuration to override this default behaviour."),Object(l.b)("h2",{id:"one-to-many"},"One to Many"),Object(l.b)("p",null,Object(l.b)("img",Object(a.a)({parentName:"p"},{src:"/img/address_city_country_er_diagram.png",alt:null}))),Object(l.b)("p",null,"For the database table relationships like above, GraphQLize infers two ",Object(l.b)("inlineCode",{parentName:"p"},"one-to-many")," relationships."),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"A ",Object(l.b)("inlineCode",{parentName:"p"},"city")," has many ",Object(l.b)("inlineCode",{parentName:"p"},"address")," (addresses) via ",Object(l.b)("inlineCode",{parentName:"p"},"city_id")," column in the ",Object(l.b)("inlineCode",{parentName:"p"},"address")," table.")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"A ",Object(l.b)("inlineCode",{parentName:"p"},"country")," has many ",Object(l.b)("inlineCode",{parentName:"p"},"city")," (cities) via ",Object(l.b)("inlineCode",{parentName:"p"},"country_id")," column in the ",Object(l.b)("inlineCode",{parentName:"p"},"city")," table."))),Object(l.b)("p",null,"GraphQLize then create two array relationships in the ",Object(l.b)("inlineCode",{parentName:"p"},"City")," and the ",Object(l.b)("inlineCode",{parentName:"p"},"Country")," type respectively."),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-graphql"}),"type City {\n  # ...\n  addresses: [Address]!\n}\n\ntype Country {\n  # ...\n  cities: [City]!\n}\n")),Object(l.b)("p",null,"The generated field name is the ",Object(l.b)("em",{parentName:"p"},"camelCase")," version of the corresponding target table's pluralized name."),Object(l.b)("p",null,"If a table has multiple foreign keys to the same table as below,"),Object(l.b)(r.a,{defaultValue:"postgres",values:[{label:"Postgres",value:"postgres"},{label:"MySQL",value:"mysql"}],mdxType:"Tabs"},Object(l.b)(o.a,{value:"postgres",mdxType:"TabItem"},Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-sql"}),"CREATE TABLE language (\n  language_id serial PRIMARY KEY,\n  name character(20) NOT NULL\n);\n\nCREATE TABLE film (\n  film_id serial PRIMARY KEY,\n  title character varying(255) NOT NULL,\n\n  language_id smallint NOT NULL REFERENCES language(language_id),\n  original_language_id smallint REFERENCES language(language_id)\n);\n\n"))),Object(l.b)(o.a,{value:"mysql",mdxType:"TabItem"},Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-sql"}),"CREATE TABLE language (\n  language_id TINYINT UNSIGNED NOT NULL AUTO_INCREMENT,\n  name CHAR(20) NOT NULL,\n  PRIMARY KEY (language_id)\n);\n\nCREATE TABLE film (\n  film_id SMALLINT UNSIGNED NOT NULL AUTO_INCREMENT,\n  title VARCHAR(255) NOT NULL,\n  language_id TINYINT UNSIGNED NOT NULL,\n  original_language_id TINYINT UNSIGNED DEFAULT NULL,\n  PRIMARY KEY  (film_id),\n  CONSTRAINT fk_film_language FOREIGN KEY (language_id) REFERENCES language (language_id),\n  CONSTRAINT fk_film_language_original FOREIGN KEY (original_language_id) REFERENCES language (language_id)\n);\n")))),Object(l.b)("p",null,"GraphQLize creates two ",Object(l.b)("inlineCode",{parentName:"p"},"one-to-many")," relationships between ",Object(l.b)("inlineCode",{parentName:"p"},"language")," and ",Object(l.b)("inlineCode",{parentName:"p"},"films"),". "),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},"The ",Object(l.b)("inlineCode",{parentName:"li"},"language")," has many ",Object(l.b)("inlineCode",{parentName:"li"},"film")," (films) via ",Object(l.b)("inlineCode",{parentName:"li"},"language_id")," column in the ",Object(l.b)("inlineCode",{parentName:"li"},"film")," table. "),Object(l.b)("li",{parentName:"ul"},"The ",Object(l.b)("inlineCode",{parentName:"li"},"language")," has many ",Object(l.b)("inlineCode",{parentName:"li"},"film")," (films) via ",Object(l.b)("inlineCode",{parentName:"li"},"original_language_id")," column in the ",Object(l.b)("inlineCode",{parentName:"li"},"film")," table.")),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-graphql"}),"type Language {\n  languageId: Int!\n  name: String!\n\n  films: [Film]!\n  originalLanguageFilms: [Film]!\n}\n")),Object(l.b)("p",null,"The nomenclature used here to generate the field name follows the below logic."),Object(l.b)("p",null,"If the column name (",Object(l.b)("inlineCode",{parentName:"p"},"language_id"),") after the removal of the foreign key suffix (",Object(l.b)("inlineCode",{parentName:"p"},"language"),") matches the source table name, then the resulting field name is the ",Object(l.b)("em",{parentName:"p"},"camelCase")," version of the pluralized form of the  table (",Object(l.b)("inlineCode",{parentName:"p"},"films"),")."),Object(l.b)("p",null,"If the column name (",Object(l.b)("inlineCode",{parentName:"p"},"original_language_id"),") after the removal of the foreign key suffix (",Object(l.b)("inlineCode",{parentName:"p"},"original_language"),") did not match the source table name, then GraphQLize removes the foreign key suffix and concatenate with the pluralized form of the target table and then convert it to its ",Object(l.b)("em",{parentName:"p"},"camelCase")," version (",Object(l.b)("inlineCode",{parentName:"p"},"originalLanguageFilms"),")."),Object(l.b)("h2",{id:"many-to-many"},"Many to Many"),Object(l.b)("p",null,"The ",Object(l.b)("inlineCode",{parentName:"p"},"many-to-many")," relationship is a bit tricky to figure out. "),Object(l.b)("p",null,"GraphQLize traverses each table's metadata to figure out whether it is an ",Object(l.b)("a",Object(a.a)({parentName:"p"},{href:"https://en.wikipedia.org/wiki/Associative_entity"}),"associative table")," or not. "),Object(l.b)("p",null,"A table is considered as an associative table if it satisfies the following two criteria"),Object(l.b)("ol",null,Object(l.b)("li",{parentName:"ol"},"It should have a primary key made of two columns."),Object(l.b)("li",{parentName:"ol"},"These primary key columns should be a subset of the foreign key columns present in that table. ")),Object(l.b)("p",null,"For the database table relationships like below,"),Object(l.b)("p",null,Object(l.b)("img",Object(a.a)({parentName:"p"},{src:"/img/film_actor_er_diagram.png",alt:null}))),Object(l.b)("p",null,"The ",Object(l.b)("inlineCode",{parentName:"p"},"film_actor")," table is an associative table as"),Object(l.b)("ol",null,Object(l.b)("li",{parentName:"ol"},"It has ",Object(l.b)("inlineCode",{parentName:"li"},"actor_id")," and ",Object(l.b)("inlineCode",{parentName:"li"},"film_id")," as the primary keys."),Object(l.b)("li",{parentName:"ol"},"The primay keys ",Object(l.b)("inlineCode",{parentName:"li"},"{actor_id, film_id}")," is a subset of foreign keys ",Object(l.b)("inlineCode",{parentName:"li"},"{actor_id, film_id}")," of the ",Object(l.b)("inlineCode",{parentName:"li"},"film_actor")," table. ")),Object(l.b)("p",null,"In this scenario, GraphQLize creates two array fields for these two ",Object(l.b)("inlineCode",{parentName:"p"},"many-to-many")," relationships.  "),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-graphql"}),"type Film {\n  actors: [Actor]!\n  # ...\n}\ntype Actor {\n  films: [Film]!\n  # ...\n}\n")),Object(l.b)("p",null,"For the relationships between ",Object(l.b)("inlineCode",{parentName:"p"},"film")," & ",Object(l.b)("inlineCode",{parentName:"p"},"film_actor")," and ",Object(l.b)("inlineCode",{parentName:"p"},"film_actor")," & ",Object(l.b)("inlineCode",{parentName:"p"},"actor")," tables, GraphQLize creates the following fields. "),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-graphql"}),"type Film {\n  # ...\n  filmActors: [FilmActor]!\n}\n\ntype FilmActor {\n  actor: Actor!\n  film: Film!\n  # ...\n}\n\ntype Actor {\n  # ...\n  filmActors: [FilmActor]!\n}\n")),Object(l.b)("h2",{id:"foreign-key-without-the-id-suffix"},"Foreign Key Without the Id Suffix"),Object(l.b)("p",null,"If the foreign key in question doesn't have the id suffix ",Object(l.b)("inlineCode",{parentName:"p"},"_id"),", then the GraphQLize follows a different approach to name the fields."),Object(l.b)("p",null,"Say, we have a below schema"),Object(l.b)(r.a,{defaultValue:"postgres",values:[{label:"Postgres",value:"postgres"},{label:"MySQL",value:"mysql"}],mdxType:"Tabs"},Object(l.b)(o.a,{value:"postgres",mdxType:"TabItem"},Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-sql"}),"CREATE TABLE continent (\n  id SERIAL PRIMARY KEY,\n  name TEXT NOT NULL\n);\nCREATE TABLE country (\n  id SERIAL PRIMARY KEY,\n  name TEXT NOT NULL,\n  continent_identifier int REFERENCES continent(id)\n);\n"))),Object(l.b)(o.a,{value:"mysql",mdxType:"TabItem"},Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-sql"}),"CREATE TABLE continent (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  name TEXT NOT NULL\n);\nCREATE TABLE country (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  name TEXT NOT NULL,\n  continent_identifier INT NOT NULL,\n  CONSTRAINT `fk_continent_country` FOREIGN KEY (`continent_identifier`) REFERENCES `continent` (`id`)\n);\n")))),Object(l.b)("p",null,"The ",Object(l.b)("inlineCode",{parentName:"p"},"continent_identifier")," column doesn't have the foreign key suffix (",Object(l.b)("inlineCode",{parentName:"p"},"_id"),"). "),Object(l.b)("p",null,"For the ",Object(l.b)("inlineCode",{parentName:"p"},"one-to-one")," relationship, GraphQLize creates a field with the name ",Object(l.b)("inlineCode",{parentName:"p"},"continentByContinentIdentifer"),". The convention is ",Object(l.b)("inlineCode",{parentName:"p"},"{targetTableName}By{FKeyColumnNameInPascalCase}"),"."),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-graphql"}),"type Country {\n  # ...\n  continentByContinentIdentifer : Continent!\n}\n")),Object(l.b)("p",null,"On the ",Object(l.b)("inlineCode",{parentName:"p"},"one-to-many")," side, the field name is the concatenation of the ",Object(l.b)("em",{parentName:"p"},"camelCase")," version of the foreign key column name (",Object(l.b)("inlineCode",{parentName:"p"},"continentIdentifer"),") with the pluralized form of the target table (",Object(l.b)("inlineCode",{parentName:"p"},"Countries"),")."),Object(l.b)("pre",null,Object(l.b)("code",Object(a.a)({parentName:"pre"},{className:"language-graphql"}),"type Continent {\n  # ...\n  continentIdentiferCountries: [Country]!\n}\n")))}m.isMDXComponent=!0},160:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return d}));var a=n(0),i=n.n(a);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var b=i.a.createContext({}),p=function(e){var t=i.a.useContext(b),n=t;return e&&(n="function"==typeof e?e(t):o({},t,{},e)),n},s=function(e){var t=p(e.components);return i.a.createElement(b.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},u=Object(a.forwardRef)((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,r=e.parentName,b=c(e,["components","mdxType","originalType","parentName"]),s=p(n),u=a,d=s["".concat(r,".").concat(u)]||s[u]||m[u]||l;return n?i.a.createElement(d,o({ref:t},b,{components:n})):i.a.createElement(d,o({ref:t},b))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,r=new Array(l);r[0]=u;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o.mdxType="string"==typeof e?e:a,r[1]=o;for(var b=2;b<l;b++)r[b]=n[b];return i.a.createElement.apply(null,r)}return i.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},161:function(e,t,n){var a;!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var a=arguments[t];if(a){var l=typeof a;if("string"===l||"number"===l)e.push(a);else if(Array.isArray(a)&&a.length){var r=i.apply(null,a);r&&e.push(r)}else if("object"===l)for(var o in a)n.call(a,o)&&a[o]&&e.push(o)}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(a=function(){return i}.apply(t,[]))||(e.exports=a)}()},162:function(e,t,n){"use strict";var a=n(0);const i=Object(a.createContext)({tabGroupChoices:{},setTabGroupChoices:()=>{}});t.a=i},163:function(e,t,n){"use strict";var a=n(0),i=n.n(a);t.a=function(e){return i.a.createElement("div",null,e.children)}},164:function(e,t,n){"use strict";var a=n(0),i=n.n(a),l=n(162);var r=function(){return Object(a.useContext)(l.a)},o=n(161),c=n.n(o),b=n(95),p=n.n(b);const s=37,m=39;t.a=function(e){const{block:t,children:n,defaultValue:l,values:o,groupId:b}=e,{tabGroupChoices:u,setTabGroupChoices:d}=r(),[O,h]=Object(a.useState)(l);if(null!=b){const e=u[b];null!=e&&e!==O&&h(e)}const g=e=>{h(e),null!=b&&d(b,e)},j=[];return i.a.createElement("div",null,i.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:c()("tabs",{"tabs--block":t})},o.map(({value:e,label:t})=>i.a.createElement("li",{role:"tab",tabIndex:"0","aria-selected":O===e,className:c()("tab-item",p.a.tabItem,{"tab-item--active":O===e}),key:e,ref:e=>j.push(e),onKeyDown:e=>((e,t,n)=>{switch(n.keyCode){case m:((e,t)=>{const n=e.indexOf(t)+1;e[n]?e[n].focus():e[0].focus()})(e,t);break;case s:((e,t)=>{const n=e.indexOf(t)-1;e[n]?e[n].focus():e[e.length-1].focus()})(e,t)}})(j,e.target,e),onFocus:()=>g(e),onClick:()=>g(e)},t))),i.a.createElement("div",{role:"tabpanel",className:"margin-vert--md"},a.Children.toArray(n).filter(e=>e.props.value===O)[0]))}}}]);